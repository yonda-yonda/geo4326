import {
  distance,
  area
} from "./spheroid";

it("distance", () => {
  expect(
    distance([
      [170.08785502777778, 36.10377477777778],
      [170.08785502777778, 36.10377477777778],
    ])
  ).toBe(0);
  expect(
    distance([
      [170.08785502777778, 36.10377477777778],
      [129.74475044444443, 35.65502847222223],
    ])
  ).toBe(3616673.1034550117);

  expect(
    distance(
      [
        [170.08785502777778, 36.10377477777778],
        [129.74475044444443, 35.65502847222223],
      ], {
        flattening: 298.257222101,
        truncation: 1e-14,
      }
    )
  ).toBe(3616673.103475374); // 3616673.103m (maps.gsi.go.jp)

  expect(
    distance(
      [
        [180, 0],
        [0, 0],
      ], {
        flattening: 298.257222101,
        truncation: 1e-14,
      }
    ) // zone3
  ).toBe(20003931.458259627); // 20003931.458m (maps.gsi.go.jp)

  expect(
    distance([
      [2.77130126953125, -52.71965835721979],
      [135.66192626953128, 78.55285943381288],
    ]) // zone2
  ).toBe(16603954.041918853);

  expect(
    distance(
      [
        [2.77130126953125, -52.71965835721979],
        [135.66192626953128, 78.55285943381288],
      ], {
        flattening: 298.257222101,
        truncation: 1e-14,
      }
    ) // zone2
  ).toBe(16603954.041728579); // 16603.954 km (maps.gsi.go.jp)

  expect(
    distance([
      [129.33380126953128, 70.48273108822767],
      [231.28692626953128, 39.609920257000795],
    ])
  ).toBe(6331800.020131769);

  expect(
    distance(
      [
        [129.33380126953128, 70.48273108822767],
        [231.28692626953128, 39.609920257000795],
      ], {
        flattening: 298.257222101,
        truncation: 1e-14,
      }
    )
  ).toBe(6331800.020177202); // 6331.800 km (maps.gsi.go.jp)

  expect(
    distance({
      type: "Feature",
      geometry: {
        type: "LineString",
        coordinates: [
          [170.08785502777778, 36.10377477777778],
          [129.74475044444443, 35.65502847222223],
        ],
      },
      properties: {}
    })
  ).toBe(3616673.1034550117);
  expect(
    distance({
      type: "LineString",
      coordinates: [
        [170.08785502777778, 36.10377477777778],
        [129.74475044444443, 35.65502847222223],
      ],
    })
  ).toBe(3616673.1034550117);
  expect(
    distance({
      type: "MultiLineString",
      coordinates: [
        [
          [170.08785502777778, 36.10377477777778],
          [129.74475044444443, 35.65502847222223],
        ],
        [
          [170.08785502777778, 36.10377477777778],
          [129.74475044444443, 35.65502847222223],
        ],
      ],
    })
  ).toBe(3616673.1034550117 * 2);

  expect(
    distance({
      type: "Polygon",
      coordinates: [
        [
          [144.84031677246097, -7.184694613606626],
          [135.78758239746097, -5.437604535460703],
          [132.62351989746097, -9.098706726260481],
          [130.95359802246097, -19.473713410647047],
          [155.56297302246097, -19.556554999011606],
          [144.84031677246097, -7.184694613606626],
        ],
      ],
    })
  ).toBe(7091079.593708386);
  expect(
    distance({
      type: "MultiPolygon",
      coordinates: [
        [
          [
            [144.84031677246097, -7.184694613606626],
            [135.78758239746097, -5.437604535460703],
            [132.62351989746097, -9.098706726260481],
            [130.95359802246097, -19.473713410647047],
            [155.56297302246097, -19.556554999011606],
            [144.84031677246097, -7.184694613606626],
          ],
        ],
        [
          [
            [144.84031677246097, -7.184694613606626],
            [135.78758239746097, -5.437604535460703],
            [132.62351989746097, -9.098706726260481],
            [130.95359802246097, -19.473713410647047],
            [155.56297302246097, -19.556554999011606],
            [144.84031677246097, -7.184694613606626],
          ],
        ],
      ],
    })
  ).toBe(7091079.593708386 * 2);
});

it("area", () => {
  expect(
    area([
      [-4.921875000000001, 29.53522956294847],
      [62.57812500000001, 76.01609366420996],
      [112.50000000000001, -55.37911044801049],
      [-4.921875000000001, 29.53522956294847],
    ])
  ).toBe(96275969765399.52);

  expect(
    area(
      [
        [-4.921875000000001, 29.53522956294847],
        [62.57812500000001, 76.01609366420996],
        [112.50000000000001, -55.37911044801049],
        [-4.921875000000001, 29.53522956294847],
      ], {
        flattening: 298.257222101,
      }
    )
  ).toBe(96275969763778.52); // 96275969.764 km2 (maps.gsi.go.jp)

  expect(
    area([
      [144.84031677246097, -7.184694613606626],
      [135.78758239746097, -5.437604535460703],
      [132.62351989746097, -9.098706726260481],
      [130.95359802246097, -19.473713410647047],
      [155.56297302246097, -19.556554999011606],
      [144.84031677246097, -7.184694613606626],
    ])
  ).toBe(2839026248376.057);

  expect(
    area(
      [
        [144.84031677246097, -7.184694613606626],
        [135.78758239746097, -5.437604535460703],
        [132.62351989746097, -9.098706726260481],
        [130.95359802246097, -19.473713410647047],
        [155.56297302246097, -19.556554999011606],
        [144.84031677246097, -7.184694613606626],
      ], {
        flattening: 298.257222101,
      }
    )
  ).toBe(2839026248293.917); // 2839026.248 km2 (maps.gsi.go.jp)

  expect(
    area([
      [246.75567626953128, 17.607375018147252],
      [134.25567626953128, 78.6915683069083],
      [89.95880126953125, -23.599228183239397],
      [246.75567626953128, 17.607375018147252],
    ])
  ).toBe(119208687689312);

  expect(
    area(
      [
        [246.75567626953128, 17.607375018147252],
        [134.25567626953128, 78.6915683069083],
        [89.95880126953125, -23.599228183239397],
        [246.75567626953128, 17.607375018147252],
      ], {
        flattening: 298.257222101,
      }
    )
  ).toBe(119208687687359.17); // 119208687.687 km2 (maps.gsi.go.jp)

  expect(
    area([
      [259.4119262695313, -46.82637528602131],
      [216.52130126953128, -15.660064992067259],
      [179.25567626953128, 13.544541117879882],
      [164.49005126953128, 32.810361684869015],
      [166.59942626953125, 45.80199916666154],
      [182.06817626953128, 55.156904807126104],
      [198.94317626953128, 64.3042040393387],
      [185.58380126953128, 71.62387456375889],
      [164.49005126953128, 74.29694963678448],
      [119.49005126953126, 73.91181655638881],
      [83.63067626953126, 62.41327269451551],
      [74.49005126953126, 43.297198404646366],
      [71.67755126953126, -17.00951473208515],
      [96.99005126953126, -8.79279689256555],
      [134.95880126953128, 16.262140786929578],
      [144.09942626953128, -4.603802664823001],
      [153.94317626953128, -41.79998325207397],
      [183.47442626953125, -28.647210004919984],
      [203.16192626953125, -31.08586989620834],
      [222.84942626953125, -42.83972354764084],
      [233.39630126953128, -53.9787048350094],
      [259.4119262695313, -46.82637528602131],
    ])
  ).toBe(407613032717113.9);

  expect(
    area(
      [
        [259.4119262695313, -46.82637528602131],
        [216.52130126953128, -15.660064992067259],
        [179.25567626953128, 13.544541117879882],
        [164.49005126953128, 32.810361684869015],
        [166.59942626953125, 45.80199916666154],
        [182.06817626953128, 55.156904807126104],
        [198.94317626953128, 64.3042040393387],
        [185.58380126953128, 71.62387456375889],
        [164.49005126953128, 74.29694963678448],
        [119.49005126953126, 73.91181655638881],
        [83.63067626953126, 62.41327269451551],
        [74.49005126953126, 43.297198404646366],
        [71.67755126953126, -17.00951473208515],
        [96.99005126953126, -8.79279689256555],
        [134.95880126953128, 16.262140786929578],
        [144.09942626953128, -4.603802664823001],
        [153.94317626953128, -41.79998325207397],
        [183.47442626953125, -28.647210004919984],
        [203.16192626953125, -31.08586989620834],
        [222.84942626953125, -42.83972354764084],
        [233.39630126953128, -53.9787048350094],
        [259.4119262695313, -46.82637528602131],
      ], {
        flattening: 298.257222101,
      }
    )
  ).toBe(407613032713194.8); // 407613032.713 km2 (maps.gsi.go.jp)

  expect(
    area({
      type: "Feature",
      geometry: {
        type: "Polygon",
        coordinates: [
          [
            [35, 10],
            [45, 45],
            [15, 40],
            [10, 20],
            [35, 10],
          ],
          [
            [20, 30],
            [35, 35],
            [30, 20],
            [20, 30],
          ],
        ],
      },
      properties: {}
    })
  ).toBe(7158593915761.758);

  expect(
    area({
      type: "Polygon",
      coordinates: [
        [
          [35, 10],
          [45, 45],
          [15, 40],
          [10, 20],
          [35, 10],
        ],
      ],
    })
  ).toBe(8233200413903.076);

  expect(
    area({
      type: "MultiPolygon",
      coordinates: [
        [
          [
            [35, 10],
            [45, 45],
            [15, 40],
            [10, 20],
            [35, 10],
          ],
          [
            [20, 30],
            [35, 35],
            [30, 20],
            [20, 30],
          ],
        ],
        [
          [
            [20, 30],
            [30, 20],
            [35, 35],
            [20, 30],
          ],
        ],
      ],
    })
  ).toBe(8233200413903.076);
});