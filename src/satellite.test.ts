import {
  nadir,
  subSatelliteTrack,
  toLonLat,
  footprint,
  accessArea,
} from "./satellite";
import { LookingAwayError } from "./errors";

// SENTINEL-1A
const tle1 = [
  "1 39634U 14016A   23261.85348622  .00000345  00000+0  82867-4 0  9995",
  "2 39634  98.1824 267.8728 0001359  89.0679 271.0677 14.59199306503843",
];
// CAPELLA-6-WHITNEY
const tle2 = [
  "1 48605U 21041BE  23261.72683319  .00062582  00000+0  29573-2 0  9994",
  "2 48605  53.0242 258.7247 0012372  12.4205 347.7091 15.18777464128591",
];

it("nadir", () => {
  expect(nadir(tle1[0], tle1[1], new Date("2023-09-21T20:00:00Z"))).toEqual([
    152.63639371243076, 15.4476525220903,
  ]);
  expect(nadir(tle1[0], tle1[1], new Date("2023-09-23T01:15:00Z"))).toEqual([
    -156.7709990357516, 79.17164810392494,
  ]);

  expect(nadir(tle2[0], tle2[1], new Date("2023-09-21T20:45:00Z"))).toEqual([
    168.60586469100184, -47.9046033988177,
  ]);
  expect(nadir(tle2[0], tle2[1], new Date("2023-09-21T20:50:00Z"))).toEqual([
    -163.89771109395022, -53.0596273195754,
  ]);
});

it("subSatelliteTrack", () => {
  expect(
    subSatelliteTrack(
      tle1[0],
      tle1[1],
      new Date("2023-09-21T00:00:00Z"),
      new Date("2023-09-21T02:00:00Z")
    )
  ).toEqual([
    [
      [112.40566283334734, 69.132372254913],
      [111.29931943395741, 68.23922036040794],
      [110.27126916586553, 67.33995295360641],
      [109.31297793660059, 66.43525293870073],
      [108.41704301844753, 65.52570338812012],
      [107.5770302572435, 64.61181292046084],
      [106.78731693388194, 63.69401518097891],
      [106.04298065270935, 62.77268877983831],
      [105.33969619625007, 61.848163884371736],
      [104.67365084225514, 60.920729542764576],
      [104.04147152425305, 59.99063741392522],
      [103.44017092654127, 59.05811618564242],
      [102.8670870229673, 58.12336177011583],
      [102.3198462643149, 57.186550205179635],
      [101.79632513110042, 56.24783831457802],
      [101.29461868675006, 55.30736624476623],
      [100.8130124503677, 54.36525725031619],
      [100.34996404535575, 53.42162901391014],
      [99.90407599517397, 52.476581007403894],
      [99.47408337243708, 51.53020531780671],
      [99.05883762152602, 50.582585447403694],
      [98.65729357834567, 49.633797323193306],
      [98.26849814428982, 48.68391017270971],
      [97.8915794687043, 47.73298489366478],
      [97.525742044086, 46.78108428624902],
      [97.17025341051178, 45.82825928785451],
      [96.82444127438403, 44.87455904584626],
      [96.48768663395218, 43.92002897668323],
      [96.15941854360346, 42.96471116181629],
      [95.83910868345251, 42.008642292501726],
      [95.5262704381857, 41.05186359789198],
      [95.22045039668862, 40.094406695233644],
      [94.92122831407688, 39.13630344896699],
      [94.62821337411452, 38.177583785332565],
      [94.34104155905888, 37.21827588672828],
      [94.05937330136346, 36.25840636546496],
      [93.78289066977092, 35.29799800363351],
      [93.51129823677859, 34.3370795540033],
      [93.2443171771923, 33.37567137507673],
      [92.98168651109728, 32.41379520243481],
      [92.72316098630627, 31.451471835708592],
      [92.4685098004508, 30.48872122985924],
      [92.21751480796206, 29.525560155043678],
      [91.96997197940685, 28.562011959684213],
      [91.72568664476334, 27.598092105880053],
      [91.48447514682036, 26.633817916803746],
      [91.24616339447914, 25.66920621009073],
      [91.01058612390541, 24.704273347399013],
      [90.7775856325226, 23.739032851767835],
      [90.54701349601868, 22.773505157593412],
      [90.31872646812249, 21.807703084337216],
      [90.09258830774809, 20.841641577686495],
      [89.8684686862228, 19.8753353128115],
      [89.64624274087075, 18.908798721582716],
      [89.42579064620173, 17.94204601711732],
      [89.20699667151264, 16.9750887843034],
      [88.98975101056652, 16.007945726259262],
      [88.77394613753978, 15.040628093542],
      [88.55947868891856, 14.073149425924623],
      [88.34624861084514, 13.105523135898183],
      [88.13415887169384, 12.137762521964888],
      [87.92311466830522, 11.169878346632505],
      [87.71302528474335, 10.201888582758949],
      [87.50380067596969, 9.233803820354403],
      [87.29535335586014, 8.265637010322],
      [87.08759764920094, 7.29740103869696],
      [86.88044947992067, 6.329108733819266],
      [86.67382564660288, 5.360770437842821],
      [86.46764570646437, 4.392403752579387],
      [86.26182866535417, 3.42401893520675],
      [86.05629487561345, 2.4556286430315026],
      [85.85096532544131, 1.4872455033144365],
      [85.64576147016528, 0.5188821177352438],
      [85.44060504861127, -0.4494489333307255],
      [85.23541739612291, -1.4177375213683976],
      [85.03012133006942, -2.385966226408561],
      [84.82463788377122, -3.354124941810268],
      [84.61888818900725, -4.322201130539927],
      [84.41279278639863, -5.290182255550242],
      [84.20627144211538, -6.258055775086525],
      [83.99924244473438, -7.225811570916133],
      [83.79162449444527, -8.193432209223102],
      [83.58333339381393, -9.160907535617826],
      [83.374283918095, -10.128224934337172],
      [83.16438909567869, -11.09537175469088],
      [82.95355998181958, -12.062335303162987],
      [82.74170490819215, -13.029105265372962],
      [82.52873136886673, -13.995663972847083],
      [82.3145425804389, -14.96200097833125],
      [82.09903934224236, -15.928103319321561],
      [81.88211922759629, -16.893957936087673],
      [81.66367628462739, -17.859551657027215],
      [81.4436007247445, -18.824871182441154],
      [81.22177802129609, -19.789905492839903],
      [80.99809078833074, -20.754636123198274],
      [80.77241504602777, -21.719051700914683],
      [80.54462203433194, -22.683138214159197],
      [80.31457720847449, -23.646881412076844],
      [80.08213976414918, -24.610266775119076],
      [79.84716151485414, -25.573281903445835],
      [79.60948870696285, -26.53590679543242],
      [79.36895785835772, -27.498128337286275],
      [79.12539745803328, -28.459930571752267],
      [78.87862665212094, -29.421297071572145],
      [78.62845446114507, -30.38221088580358],
      [78.37467891865548, -31.34265448051483],
      [78.1170854787005, -32.30261208648135],
      [77.85544859023022, -33.262059972379284],
      [77.58952667810584, -34.22098084784975],
      [77.31906348334991, -35.179354117815876],
      [77.04378605200218, -36.1371581983441],
      [76.7634032255256, -37.09437040726082],
      [76.4776032490122, -38.05096924710436],
      [76.1860548095472, -39.006924649644496],
      [75.88840068194975, -39.962212257769266],
      [75.58425830848857, -40.916803633894666],
      [75.2732165575788, -41.870668478147415],
      [74.95483290027029, -42.82377441788572],
      [74.6286294159344, -43.77608916529029],
      [74.29409256484475, -44.727570675528256],
      [73.95066429545655, -45.67818121631384],
      [73.59774084742845, -46.627877450447684],
      [73.23466691391103, -47.57661245082371],
      [72.860729964294, -48.52433526910111],
      [72.4751538150623, -49.47099044585393],
      [72.0770903237293, -50.41651982896201],
      [71.66561512905776, -51.36085242936889],
      [71.23971218791267, -52.303917958174054],
      [70.79826693941884, -53.24563647679007],
      [70.34005292430011, -54.18591981309884],
      [69.86371754599108, -55.124670449559794],
      [69.3677643878819, -56.06178258953832],
      [68.85053928170737, -56.99713123880516],
      [68.31020085303152, -57.93058459902132],
      [67.74469990259692, -58.86199259471551],
      [67.15174840418112, -59.79118683231516],
      [66.52878466586671, -60.71797777092351],
      [65.87293079532009, -61.642153693655274],
      [65.18095132321068, -62.56346743800521],
      [64.44918662886873, -63.481645589388116],
      [63.67349238790287, -64.39637348386572],
      [62.84915841048405, -65.307290679868],
      [61.970814055781155, -66.21398266792058],
      [61.03231554322499, -67.11597080028929],
      [60.026608882772344, -68.01270225086232],
      [58.94557962827062, -68.903525948326],
      [57.77984614341772, -69.78768757111933],
      [56.51854133480457, -70.66429760547115],
      [55.14903952533739, -71.53230519793121],
      [53.65663782071726, -72.39046282225644],
      [52.02418137378828, -73.23728436856045],
      [50.23165827232678, -74.07098178328789],
      [48.25571063604434, -74.88940960057542],
      [46.069169129679985, -75.68997194605743],
      [43.640604924463005, -76.46952128116715],
      [40.93402715895342, -77.22423408855916],
      [37.9089062882545, -77.94946599496568],
      [34.52081897423299, -78.63959346202861],
      [30.723234261207402, -79.28784701815042],
      [26.47095381150297, -79.88619375559506],
      [21.726112027527872, -80.42529117033116],
      [16.467142009951797, -80.89462590936678],
      [10.70044490140179, -81.28293672790937],
      [4.4726716691026525, -81.5790198548828],
      [-2.1206985784851304, -81.77291892383147],
      [-8.936523348647015, -81.85733727688893],
      [-15.798463287170273, -81.82888321393284],
      [-22.52289378522685, -81.68871491145792],
      [-28.94749854925553, -81.4423158836511],
      [-34.95218922864475, -81.09849543675966],
      [-40.466618291235925, -80.66800746504556],
      [-45.465813104411346, -80.16221043524205],
      [-49.95900924940978, -79.59206445485621],
      [-53.97728236700103, -78.96752632507933],
      [-57.56310806159224, -78.29728456256983],
      [-60.762933091371046, -77.58872372669062],
      [-63.622549797256134, -76.8480152587452],
      [-66.18454188727883, -76.08027437697467],
      [-68.48719764071281, -75.28971158597423],
      [-70.56419091616127, -74.47979360814591],
      [-72.4447587825554, -73.65337637295646],
      [-74.15409243663807, -72.81281866574982],
      [-75.71381318834621, -71.96007351820852],
      [-77.14243464705056, -71.0967727587126],
      [-78.45583107571608, -70.2242753242237],
      [-79.66761784407528, -69.34372493409721],
      [-80.78949962248072, -68.45608736991315],
      [-81.83156428554248, -67.56218212871404],
      [-82.80253385087511, -66.66270563910295],
      [-83.70996396323756, -65.75826090676244],
      [-84.56043381861758, -64.84936063112195],
      [-85.35968307577437, -63.936449828605014],
      [-86.11273739838519, -63.01991468902705],
      [-86.82401161820843, -62.10009170243878],
      [-87.49739641191911, -61.177275189677985],
      [-88.1363328514696, -60.25172121306815],
      [-88.74386767331441, -59.323662088553604],
      [-89.32271505081353, -58.39329676474527],
      [-89.87529436028889, -57.46080377367632],
      [-90.40376952094935, -56.52634198196112],
      [-90.91008117037198, -55.59005319383043],
      [-91.39597543708939, -54.65206200241117],
      [-91.86302277687852, -53.712487115233564],
      [-92.31264569957344, -52.771428816977725],
      [-92.74613146843538, -51.828979787398666],
      [-93.16464861932269, -50.885223940470105],
      [-93.56926023553092, -49.940237458261514],
      [-93.96093648345398, -48.9940873071317],
      [-94.34056080894801, -48.04684153742272],
      [-94.70894469625733, -47.098555688927554],
      [-95.06683146657832, -46.149282900263884],
      [-95.41490412660724, -45.19907205348389],
      [-95.75379139666276, -44.24796823341655],
      [-96.08407305610969, -43.29601313261061],
      [-96.40628547196452, -42.343243012348154],
      [-96.7209225858151, -41.38969860476259],
      [-97.02844451385005, -40.43541101906827],
      [-97.32927762700884, -39.480411572902796],
      [-97.62381835637507, -38.52472962027575],
      [-97.91243586472342, -37.56839275041581],
      [-98.19547515546218, -36.61142455839642],
      [-98.47325639232203, -35.65385443137097],
      [-98.7460811139359, -34.6957032530884],
      [-99.01423113074132, -33.73699315605658],
      [-99.27797082336161, -32.7777452312825],
      [-99.53754858540944, -31.817979632104006],
      [-99.79319811974062, -30.857715667763166],
      [-100.04514025857833, -29.896969471412696],
      [-100.29358150919437, -28.935763741020644],
      [-100.53871884334214, -27.97411331305631],
      [-100.78073805144497, -27.012034887095645],
      [-101.01981519668996, -26.049544666966263],
      [-101.25611737671927, -25.086658411788935],
      [-101.48980399133559, -24.12338905954328],
      [-101.72102503935128, -23.159756458717872],
      [-101.94992522888356, -22.195772872968895],
      [-102.17664215837131, -21.231452703380256],
      [-102.40130740967449, -20.26681009786274],
      [-102.62404701113866, -19.301858979332913],
      [-102.84498242154424, -18.33661064369937],
      [-103.06422870845144, -17.37108349240886],
      [-103.28189825942167, -16.405288490208015],
      [-103.49809889780991, -15.439238892052492],
      [-103.71293477095182, -14.47294783333847],
      [-103.92650665439545, -13.506428345318222],
      [-104.13891223808452, -12.53969336900077],
      [-104.3502469325911, -11.572753336032164],
      [-104.56060199771726, -10.60562590624675],
      [-104.77006797814613, -9.638321389226661],
      [-104.97873280795416, -8.670852478783646],
      [-105.1866825617321, -7.703231830101824],
      [-105.39400166974339, -6.735472067227302],
      [-105.60077364216713, -5.767583355976072],
      [-105.80707918749323, -4.7995831457228135],
      [-106.0129995237834, -3.8314815721387716],
      [-106.21861448310933, -2.8632911974257995],
      [-106.42400321708655, -1.8950245815351545],
      [-106.62924437410281, -0.9266942867625758],
      [-106.83441679458234, 0.04168955302654441],
      [-107.03959761915182, 1.0101094877583332],
      [-107.24486556262788, 1.978555357440338],
      [-107.45029902188509, 2.9470145478471035],
      [-107.65597677047384, 3.915474421316398],
      [-107.86197813454872, 4.883922312378983],
      [-108.06838317350466, 5.852345523169824],
      [-108.2752733849339, 6.820733753620483],
      [-108.48272980928104, 7.789069355962638],
      [-108.69083634631866, 8.757341939594822],
      [-108.89967787404282, 9.725538624417872],
      [-109.10934097559323, 10.693646469151654],
      [-109.31991415506437, 11.661652463809919],
      [-109.5314885940438, 12.629545955047606],
      [-109.7441562596795, 13.597308901889061],
      [-109.95801334206568, 14.564930468548802],
      [-110.17315839157678, 15.53239727738974],
      [-110.3896931239451, 16.499695830303335],
      [-110.607722717777, 17.466812494723378],
      [-110.82735612239289, 18.433733488091242],
      [-111.04870695179109, 19.400447291225294],
      [-111.27189160830555, 20.36693490630921],
      [-111.4970330030197, 21.333184421016178],
      [-111.72425874384636, 22.299181261088293],
      [-111.95370213033398, 23.26491059558893],
      [-112.18550262686787, 24.230357308302708],
      [-112.4198069658417, 25.195508392643557],
      [-112.65676734431726, 26.160343209673155],
      [-112.896545556314, 27.12484801115633],
      [-113.13931129463685, 28.089006188287325],
      [-113.38524345357938, 29.052800651823993],
      [-113.63453089546154, 30.016213779880847],
      [-113.88737394109864, 30.979229781300813],
      [-114.14398274246193, 31.941824946511307],
      [-114.4045821098883, 32.90398210634471],
      [-114.66941008666157, 33.86568086642482],
      [-114.93871980617675, 34.826899942500106],
      [-115.21278083603333, 35.787617064146474],
      [-115.49188065818352, 36.747808867884],
      [-115.77632703899388, 37.70745319069017],
      [-116.06644696218201, 38.66651928671128],
      [-116.36259293343268, 39.624982158451175],
      [-116.66514237171712, 40.58281273837671],
      [-116.97450080238416, 41.53998011876075],
      [-117.29110463461126, 42.49645134570823],
      [-117.61542508486757, 43.45219359049578],
      [-117.94796836957032, 44.40716427873892],
      [-118.28928448257935, 45.361325218033855],
      [-118.63996834184258, 46.314632653301324],
      [-119.00066551645601, 47.267039298458336],
      [-119.37207780019615, 48.21849391429402],
      [-119.75497049157596, 49.168943217767506],
      [-120.15017566313712, 50.118321778940924],
      [-120.55860606339229, 51.06656573816028],
      [-120.98126056788351, 52.013602530731994],
      [-121.41923571822058, 52.95935246019569],
      [-121.8737378613067, 53.90372775688499],
      [-122.34609709430389, 54.84663149112744],
      [-122.83778460058433, 55.78795867957345],
      [-123.35042621829889, 56.72758535863146],
      [-123.88583137167663, 57.665381082264865],
      [-124.44601318164597, 58.60119745499823],
      [-125.03321882166975, 59.53486815883935],
      [-125.64996359881245, 60.466206192582895],
      [-126.29907258466856, 61.39500293706864],
      [-126.9837210161318, 62.32101493774295],
      [-127.70749952327122, 63.243973287452036],
      [-128.47447330004997, 64.16356872778456],
      [-129.28926151872204, 65.07944730879481],
      [-130.15712989133362, 65.99120231427716],
      [-131.08410339111822, 66.89836673041044],
      [-132.07708847446736, 67.80039216913497],
      [-133.14404438215368, 68.69664789638936],
      [-134.29416197380206, 69.5863936502472],
      [-135.53809022319666, 70.468759627256],
      [-136.88820274582457, 71.34271881894206],
      [-138.35891246536804, 72.20705259048631],
      [-139.96704315773556, 73.06030989051457],
      [-141.732233799415, 73.90074514057574],
      [-143.67743037045273, 74.7262643858393],
      [-145.8293627280854, 75.53433391336903],
      [-148.21901751618438, 76.32188069911278],
      [-150.8819884603408, 77.08516946262132],
      [-153.85854476828615, 77.81966001172951],
      [-157.19308380518117, 78.51983825274127],
      [-160.93263402028074, 79.17906175291402],
      [-165.1236262504029, 79.78941201415878],
      [-169.80628619745727, 80.34163493724466],
      [-175.00598368906176, 80.82524289982744],
      [-180, 81.1779270007109],
    ],
    [
      [180, 81.1779270007109],
      [179.2783411183272, 81.22889151463727],
      [173.08688533639977, 81.54113734607813],
      [166.50874448887146, 81.7515999614406],
      [159.6825601544329, 81.85239432999393],
      [152.7837804326452, 81.8394583948114],
      [145.9993859654925, 81.71332466236855],
      [139.49834479083535, 81.47901585470176],
      [133.40866946555104, 81.14510899713223],
      [127.8079103020693, 80.72234591559477],
      [122.7263527927769, 80.2222357532096],
      [118.15795031818723, 79.65598037212486],
      [114.07304685885588, 79.03380941289055],
      [110.4293686623556, 78.3646760422894],
      [107.17995034789294, 77.65619912151416],
      [104.27816832632426, 76.91475595749704],
      [101.68045210367112, 76.14562124734319],
      [99.34757860990926, 75.35314065028743],
      [97.24501665317067, 74.54088758233907],
      [95.34278053077747, 73.71180296435597],
      [93.61504114334738, 72.86831323298173],
      [92.03964154219058, 72.0124253597579],
      [90.59762235611376, 71.14581436678178],
      [89.27273985435173, 70.26987391180118],
      [88.05107314826915, 69.38577580976947],
      [86.92066491655486, 68.49450871914779],
      [85.8712181063222, 67.59691089381617],
      [84.8938371432885, 66.69369424362714],
      [83.9808220620989, 65.78547468271263],
      [83.1254732134009, 64.87277570910143],
      [82.32195012849031, 63.95605147281145],
      [81.56514247836354, 63.035695943550934],
      [80.85056407325467, 62.112052291217694],
      [80.17426223228601, 61.185418284335924],
      [79.53274963090679, 60.256062020165444],
      [78.92293096811939, 59.32421326796863],
      [78.34205646126318, 58.39007723073932],
      [77.78767479461276, 57.453835950369715],
      [77.25759458994278, 56.51565145122366],
      [76.7498515228129, 55.57566839905762],
      [76.26267897512312, 54.63401398887907],
      [75.79448872552184, 53.69080934492911],
      [75.34384279498451, 52.74615695922512],
      [74.909440438702, 51.800151572239834],
      [74.4901013267845, 50.85287902421797],
      [74.08475204104009, 49.904417306911725],
      [73.6924133300482, 48.95483508617771],
      [73.31219375351547, 48.00420204860977],
      [72.94327476612855, 47.052575265734006],
      [72.58490680370669, 46.10000934686566],
      [72.23640132873713, 45.14655458252928],
      [71.89712470649837, 44.19225741008963],
      [71.5664919686374, 43.23715842137514],
      [71.24396531520561, 42.281302333651],
      [70.92904486623289, 41.32472390015992],
      [70.62126822014558, 40.36745779926427],
      [70.32020622113339, 39.40953648651887],
      [70.02545994240994, 38.45099041970151],
      [69.73665797893075, 37.49184825956147],
      [69.45345331190921, 36.5321346352092],
      [69.17552396150495, 35.57187995911902],
      [68.90256675154004, 34.61110609132034],
      [68.63429839542431, 33.649836120216115],
      [68.37045317410124, 32.6880920660364],
      [68.11078148871007, 31.72589498525936],
      [67.8550479020808, 30.76326264348256],
      [67.60303250693266, 29.80021928370688],
      [67.35452597979842, 28.836781179120038],
      [67.10933117165933, 27.87296638356031],
      [66.86726155161257, 26.908792373839017],
      [66.62814037977682, 25.944276106142368],
      [66.39179994749178, 24.979434067077076],
      [66.15808029543788, 24.014279892475308],
      [65.92683091781022, 23.04883411772903],
      [65.69790664652052, 22.083109653854276],
      [65.4711694605857, 21.117121528719668],
      [65.24648739552228, 20.150884491433743],
      [65.0237340744907, 19.18441304029512],
      [64.80278772429945, 18.217719017042086],
      [64.58353298743644, 17.250821353515594],
      [64.36585721832591, 16.283731507377066],
      [64.14965235469379, 15.316463203504268],
      [63.93481403579317, 14.349030020267113],
      [63.721241294392904, 13.381445404719315],
      [63.50883573269886, 12.413720252690174],
      [63.297503384159285, 11.445872655106108],
      [63.08715125112829, 10.477913308601401],
      [62.87768919818735, 9.509855258841407],
      [62.66902918521289, 8.541711476303009],
      [62.46108504222344, 7.573494864438875],
      [62.2537722580907, 6.605218267023526],
      [62.047007253188255, 5.636892039878633],
      [61.840709265403284, 4.668533796756396],
      [61.63479703062193, 3.700153805370074],
      [61.42919068453408, 2.731764732120985],
      [61.223811052254554, 1.7633792120453262],
      [61.018579474646145, 0.7950098533505128],
      [60.81341711254161, -0.17333319317800633],
      [60.60824683383421, -1.1416324901895487],
      [60.40298994591662, -2.109877919439153],
      [60.197568081971, -3.078056937649036],
      [59.9919025115448, -4.046157007270774],
      [59.785913963196386, -5.014165592052116],
      [59.57952192220538, -5.98207258612354],
    ],
  ]);

  expect(
    subSatelliteTrack(
      tle2[0],
      tle2[1],
      new Date("2023-09-21T00:00:00Z"),
      new Date("2023-09-21T02:00:00Z")
    )
  ).toEqual([
    [
      [79.21117889595232, -13.70006267534913],
      [79.75309554632716, -14.44723343496938],
      [80.29902315942479, -15.192767201691929],
      [80.84919937158234, -15.936567069530515],
      [81.40386591704782, -16.67853402706654],
      [81.96326883484164, -17.418566821008916],
      [82.52765868164082, -18.156561815238533],
      [83.09729073888958, -18.892412845163893],
      [83.67242522009019, -19.62601106712001],
      [84.25332747460749, -20.35724480265151],
      [84.840268187453, -21.08599937743128],
      [85.43352357195815, -21.812156954676258],
      [86.03337555785617, -22.535596362849525],
      [86.64011197423154, -23.25619291748331],
      [87.25402671789581, -23.97381823702423],
      [87.8754199141533, -24.688340052549304],
      [88.50459806880508, -25.399622011268146],
      [89.1418741925074, -26.107523473780955],
      [89.7875679216407, -26.81189930505334],
      [90.44200560999793, -27.51259965917222],
      [91.10552040023443, -28.209469757932485],
      [91.77845226583388, -28.90234966345105],
      [92.46114802641368, -29.59107404500758],
      [93.1539631960608, -30.27547377015809],
      [93.85725446182495, -30.95536832979225],
      [94.57139072323588, -31.630576604821222],
      [95.29674553671244, -32.300909259129746],
      [96.03369873713285, -32.966170325925525],
      [96.78263616805822, -33.62615695035017],
      [97.54394933534493, -34.28065913082572],
      [98.31803497763842, -34.92945946103749],
      [99.10529456193456, -35.572332873174794],
      [99.90613367389757, -36.20904638495802],
      [100.72096131113028, -36.83935885209603],
      [101.55018905850635, -37.46302072857266],
      [102.39423014203052, -38.07977383735956],
      [103.25349834776026, -38.68935115449681],
      [104.12840679551206, -39.29147660991303],
      [105.01936655392001, -39.88586490839581],
      [105.92678509056726, -40.47222137535143],
      [106.85106454638625, -41.05024183121552],
      [107.79259981680786, -41.61961249982427],
      [108.75177643888419, -42.1800099560235],
      [109.72896827675258, -42.73110111821977],
      [110.72453498209, -43.27254329216514],
      [111.73881925163437, -43.803984272499946],
      [112.77214385430781, -44.325062509011595],
      [113.82480844386987, -44.835407344849294],
      [114.89708615530512, -45.33463933414124],
      [115.98921999404705, -45.82237064659857],
      [117.10141902861895, -46.2982055666788],
      [118.23385441160265, -46.761741094767174],
      [119.38665524822352, -47.21256765747694],
      [120.55990434414493, -47.65026993371107],
      [121.75363387703385, -48.07442780233225],
      [122.96782103047467, -48.484617416338274],
      [124.20238364791177, -48.88041240715303],
      [125.45717597554112, -49.261385221085554],
      [126.73198454749337, -49.62710858818092],
      [128.0265243112299, -49.97715712150928],
      [129.34043505981796, -50.311109042508384],
      [130.67327826608383, -50.628548025300326],
      [132.02453441355593, -50.929065149974164],
      [133.39360090903787, -51.21226095173977],
      [134.7797906740468, -51.477747549669374],
      [136.1823315028809, -51.72515083558185],
      [137.60036625939148, -51.95411270052371],
      [139.03295399404135, -52.16429327344743],
      [140.47907592508975, -52.355373630806],
      [141.93762297504318, -52.52705597491778],
      [143.40742317478623, -52.67906881044534],
      [144.88723131597393, -52.81116683305399],
      [146.37573895798204, -52.9231333172107],
      [147.871581506324, -53.014781793105264],
      [149.3733461613786, -53.08595752154571],
      [150.87958062965745, -53.13653874010034],
      [152.38880247453798, -53.166437657303405],
      [153.8995089610136, -53.175601176037546],
      [155.41018724252874, -53.16401133214167],
      [156.91932471643878, -53.13168543971484],
      [158.42541937084235, -53.07867594029696],
      [159.92698996651905, -53.00506995892536],
      [161.4225858546412, -52.910988575767504],
      [162.9107963051202, -52.79658582744322],
      [164.39025918689944, -52.662047457053895],
      [165.85966887208707, -52.50758943622366],
      [167.3177832806567, -52.3334562859633],
      [168.7634299728695, -52.139919225820876],
      [170.1955112444247, -51.92727418257067],
      [171.6130082011724, -51.69583969055695],
      [173.01498380298577, -51.4459547158232],
      [174.40058490311753, -51.17797643539508],
      [175.76904331716054, -50.89227800159798],
      [177.11967598757835, -50.589246319230035],
      [178.4518842967406, -50.269279860892745],
      [179.76515262980286, -49.93278654289387],
      [180, -49.868787213508945],
    ],
    [
      [-180, -49.868787213508945],
      [-178.94095374174276, -49.580181681076596],
      [-177.666791358469, -49.21188604274582],
      [-176.4126417513355, -48.82832400765262],
      [-175.17871503364344, -48.42992184799168],
      [-173.9651537858231, -48.01710613436268],
      [-172.77203717259556, -47.59030227203406],
      [-171.59938521479037, -47.14993316935906],
      [-170.4471631317141, -46.69641803811857],
      [-169.31528570579778, -46.23017132365055],
      [-168.20362161229002, -45.751601761151015],
      [-167.11199766449363, -45.26111155322039],
      [-166.04020293825315, -44.759095662796874],
      [-164.9879927440171, -44.24594121483645],
      [-163.9550924249764, -43.72202699963986],
      [-162.94120095620823, -43.18772307037181],
      [-161.94599434286516, -42.643390427237485],
      [-160.96912879385664, -42.08938078071459],
      [-160.01024113605504, -41.526034863212246],
      [-159.06896178982842, -40.953688397590234],
      [-158.14490186151343, -40.372662986606535],
      [-157.23766578729644, -39.78327214075175],
      [-156.34685084097927, -39.18581983217899],
      [-155.47204904029803, -38.58060058629873],
      [-154.61284886818405, -37.96789960705121],
      [-153.76883681006686, -37.34799293099182],
      [-152.93959873493168, -36.72114760567748],
      [-152.1247211102126, -36.08762188830684],
      [-151.32379207814125, -35.44766546096568],
      [-150.53640239760216, -34.801519659140396],
      [-149.76214625878288, -34.14941771063889],
      [-149.00062198819177, -33.49158498224897],
      [-148.25143265050232, -32.828239231887565],
      [-147.51418654977692, -32.159590864217336],
      [-146.7884976554839, -31.485843187992817],
      [-146.07398594062087, -30.80719267360056],
      [-145.37027765713742, -30.12382920953308],
      [-144.67700554362895, -29.43593635666475],
      [-143.99380898356122, -28.743691599422654],
      [-143.3203341046287, -28.04726659306525],
      [-142.65623384190155, -27.34682740644754],
      [-142.00116795521782, -26.642534759742357],
      [-141.35480301381506, -25.934544256743695],
      [-140.7168123544539, -25.223006611419006],
      [-140.08687600433186, -24.50806786848319],
      [-139.46468058852489, -23.789869617892236],
      [-138.84991921288483, -23.068549203089855],
      [-138.24229132773465, -22.344239923041012],
      [-137.6415025827341, -21.617071228030856],
      [-137.04726466263682, -20.88716890929288],
      [-136.4592951167483, -20.15465528255182],
      [-135.8773171746637, -19.419649365596488],
      [-135.30105955817316, -18.682267050030124],
      [-134.7302562873459, -17.942621267339497],
      [-134.1646464757558, -17.200822149486843],
      [-133.60397413003383, -16.45697718417944],
      [-133.04798793927188, -15.711191365069986],
      [-132.4964410691702, -14.963567337024655],
      [-131.94909094331558, -14.214205536744323],
      [-131.40569903795836, -13.463204328905237],
      [-130.86603066412485, -12.710660138085569],
      [-130.32985475409814, -11.95666757665464],
      [-129.79694365180967, -11.201319568913728],
      [-129.26707147823163, -10.444705440631138],
      [-128.7400195981169, -9.686919157293037],
      [-128.2155678809197, -8.928047261500735],
      [-127.69350018234181, -8.168177098686426],
      [-127.17360271085307, -7.4073948979515825],
      [-126.65566381632237, -6.645785878231869],
      [-126.13947378376258, -5.8834343522169785],
      [-125.62482462594737, -5.120423828289874],
      [-125.11150987691093, -4.356837110666722],
      [-124.59932438794534, -3.5927563979741146],
      [-124.08806412267462, -2.828263380473491],
      [-123.5775259502623, -2.0634393361329413],
      [-123.06750744789942, -1.2983652257625002],
      [-122.55780669119528, -0.5331217874257882],
      [-122.04822205776553, 0.23221036966781103],
      [-121.53855202012339, 0.9975506715802568],
      [-121.02859494482124, 1.7628184861713823],
      [-120.51814889146277, 2.5279330295107942],
      [-120.00701140560126, 3.2928132719769843],
      [-119.4949793191298, 4.057377843856805],
      [-118.98184854556374, 4.821544940183895],
      [-118.46741387546476, 5.585232224664027],
      [-117.95146876817535, 6.3483567324284556],
      [-117.43380515098752, 7.110834771437033],
      [-116.91421320774073, 7.872581822299608],
      [-116.39248117054414, 8.633512436283905],
      [-115.86839511410544, 9.39354013134832],
      [-115.3417387406034, 10.152577285903597],
      [-114.81229317173587, 10.910535030126898],
      [-114.27983673337434, 11.667323134605562],
      [-113.74414474123769, 12.42284989605999],
      [-113.20498928974757, 13.177022019941742],
      [-112.66213903172962, 13.929744499636199],
      [-112.11535896576818, 14.680920492111337],
      [-111.5644102161074, 15.430451189691446],
      [-111.00904981994455, 16.178235687789606],
      [-110.44903050417832, 16.924170848336317],
      [-109.88410047748582, 17.66815115869203],
      [-109.3140032112019, 18.410068585787972],
      [-108.73847722629802, 19.14981242530284],
      [-108.15725588723468, 19.88726914563606],
      [-107.57006718896908, 20.62232222647749],
      [-106.97663356316114, 21.354851991757105],
      [-106.37667167803795, 22.08473543681776],
      [-105.76989224745864, 22.81184604960036],
      [-105.15599819960813, 23.536055564178323],
      [-104.5346911081878, 24.25722600737732],
      [-103.90566115760177, 24.97522115663698],
      [-103.26859356824633, 25.689898557917697],
      [-102.6231668287414, 26.40111126171141],
      [-101.96905259491167, 27.108707606148666],
      [-101.30591560402365, 27.812530993748883],
      [-100.63341361273487, 28.512419661911455],
      [-99.95119737961791, 29.208206447373847],
      [-99.2589106610552, 29.899718544887524],
      [-98.55619026509875, 30.586777260541584],
      [-97.8426661363291, 31.269197760176073],
      [-97.11796149479534, 31.94678881349376],
      [-96.38169303423687, 32.61935253466259],
      [-95.63347117417153, 33.286684120261135],
      [-94.87290038969019, 33.94857158565147],
      [-94.09957961108378, 34.60479550119863],
      [-93.3131027167547, 35.25512872938408],
      [-92.51305910911877, 35.89933616519962],
      [-91.69903440903012, 36.53717448127161],
      [-90.87061125130207, 37.16839188021798],
      [-90.02737020844893, 37.792727856809414],
      [-89.1688908534862, 38.409912972856816],
      [-88.29475295832282, 39.01966864813134],
      [-87.4045378642322, 39.62170697090652],
      [-86.49783000847924, 40.2157305325954],
      [-85.57421863328199, 40.801432290225776],
      [-84.63329969440329, 41.37849546261666],
      [-83.67467795708716, 41.946593465061106],
      [-82.69796931059331, 42.505389888593996],
      [-81.70280329947948, 43.05453853010538],
      [-80.68882587743002, 43.59368348002381],
      [-79.65570238338545, 44.12245927463983],
      [-78.60312075460467, 44.64049112053372],
      [-77.53079495625028, 45.14739519873983],
      [-76.43846862821657, 45.64277905650449],
      [-75.32591894546616, 46.12624209453679],
      [-74.19296065351897, 46.59737615749813],
      [-73.03945028026425, 47.05576623524473],
      [-71.86529047207776, 47.50099128186702],
      [-70.67043442747412, 47.932625158793556],
      [-69.45489038120783, 48.35023770737741],
      [-68.21872608141486, 48.753395954995874],
      [-66.96207319912855, 49.14166545728126],
      [-65.68513159873734, 49.51461177714488],
      [-64.38816988856385, 49.87180303567551],
      [-63.07154313717963, 50.21280786771192],
      [-61.735675363890316, 50.53720304231002],
      [-60.38107626763988, 50.84457157222755],
      [-59.00834006682075, 51.134505780643124],
      [-57.61814710304409, 51.40660947430174],
      [-56.211264682451954, 51.66050018288838],
      [-54.78854705401336, 51.895811441839165],
      [-53.350934460881795, 52.112195092734474],
      [-51.89945119707667, 52.30932357272096],
      [-50.43520262816149, 52.48689216215517],
      [-48.959371154674606, 52.64462115804526],
      [-47.473211111043106, 52.78225793991375],
      [-45.97804263523183, 52.899578894640825],
      [-44.4752445416239, 52.99639116760575],
      [-42.96624629593971, 53.072534209214936],
      [-41.45251917678578, 53.127881088546054],
      [-39.93556674867425, 53.16233954943566],
      [-38.41691481526223, 53.175852788712994],
      [-36.898100979782484, 53.16839994136424],
      [-35.38066402022362, 53.13999626302567],
      [-33.86613323550882, 53.09069300614523],
      [-32.35601795518202, 53.020576992235924],
      [-30.851797387581676, 52.92976988863267],
      [-29.354910968501322, 52.81842720386464],
      [-27.866749362142535, 52.68673702095303],
      [-26.388646243778975, 52.53491849249851],
      [-24.9218709733809, 52.36322012516218],
      [-23.467622239101296, 52.171917884017866],
      [-22.02702272615646, 51.961313149174146],
      [-20.60111484931698, 51.731730558066154],
      [-19.19085754104681, 51.48351576688692],
      [-17.79712408767125, 51.21703316386207],
      [-16.420700962247878, 50.932663565583624],
      [-15.062287610767907, 50.6308019254883],
      [-13.722497110367552, 50.311855080920935],
      [-12.40185760980037, 49.97623956225283],
      [-11.100814484035892, 49.62437948431758],
      [-9.819733081151224, 49.25670453705831],
      [-8.55890198517863, 48.87364808899049],
      [-7.318536687298401, 48.475645413859255],
      [-6.0987835848316125, 48.06313204777335],
      [-4.8997242091496975, 47.636542281336276],
      [-3.721379610895725, 47.19630778872005],
      [-2.563714829622111, 46.74285639337581],
      [-1.4266403581537546, 46.27660970083386],
      [-0.31002873409777265, 45.797987166233746],
      [0.7862993920525185, 45.30739774545956],
      [1.86255876648801, 44.80524413996753],
      [2.9189985299429946, 44.291920951138],
      [3.955898316820427, 43.76781417318415],
      [4.973564564087086, 43.23330078326639],
      [5.972327026428342, 42.68874842093379],
      [6.952535521302962, 42.13451514899723],
      [7.914556896870109, 41.57094928811732],
      [8.8587722292218, 40.99838931761209],
      [9.785574246088887, 40.417163835283866],
      [10.695364963278564, 39.827591569488476],
      [11.588553539097022, 39.229981437017756],
      [12.4655543266297, 38.62463264086918],
      [13.32678512652919, 38.0118348023544],
      [14.172665609562992, 37.39186812252823],
      [15.003615924537733, 36.765003568279276],
      [15.820055457690206, 36.131503078934195],
      [16.622401738917365, 35.491619789572454],
      [17.411069492783184, 34.84559826769984],
      [18.18646980924955, 34.193674760258],
      [18.949009435286317, 33.53607744830316],
      [19.699090166018845, 32.87302670703431],
      [20.43710833842645, 32.20473536908027],
      [21.163454410204558, 31.53140898930589],
      [21.878512615813737, 30.853246109569383],
      [22.58266069515833, 30.170438522140984],
      [23.27626968596127, 29.483171530643368],
      [23.959703770991997, 28.791624207594754],
      [24.633320180630886, 28.0959696477646],
      [25.297469133818442, 27.396375216719075],
      [25.952493827633646, 26.693002794035127],
      [26.59873045076208, 25.986009010787154],
      [27.236508240734555, 25.275545481012042],
      [27.8661495556475, 24.561759026914135],
      [28.487969978089723, 23.84479189770027],
      [29.102278436915, 23.12478198192218],
      [29.70937734482139, 22.401863013350155],
      [30.3095627521703, 21.676164770359236],
      [30.903124515187137, 20.947813268916313],
      [31.490346471138295, 20.216930949247168],
      [32.071506624934074, 19.483636856346582],
      [32.64687734315305, 18.74804681440957],
      [33.216725554868844, 18.01027359544243],
      [33.78131446032929, 17.270425095058737],
      [34.340897700155686, 16.528612433219322],
      [34.89572864775898, 15.784938199403356],
      [35.44605455424822, 15.03950453220484],
      [35.992118280075225, 14.292411279903924],
      [36.534158516956886, 13.54375613812556],
      [37.07240999761403, 12.79363478313558],
      [37.6071037137891, 12.042141000986913],
      [38.13846713097809, 11.289366812724921],
      [38.666724403315044, 10.535402595951663],
      [39.19209658554592, 9.78033720290476],
      [39.71480184816212, 9.024258075321262],
      [40.235055687670084, 8.267251356307694],
      [40.75307113526443, 7.509401999444951],
      [41.2690589705608, 6.750793875328178],
      [41.7832279232746, 5.991509875791187],
      [42.29578488664131, 5.2316320160259355],
      [42.806935117198506, 4.4712415348138],
      [43.316882442285355, 3.710418993051676],
      [43.825829464031926, 2.9492443708648306],
      [44.333977760851305, 2.187797163414867],
      [44.841528089404726, 1.4261564756955336],
      [45.34868058760435, 0.6644011164929434],
      [45.85563497380972, -0.09739030831936132],
      [46.362590745621176, -0.8591393028515304],
      [46.86974738475291, -1.6207673885489033],
      [47.37730455429733, -2.3821960115197256],
      [47.88546229731418, -3.143346449684249],
      [48.394421243551555, -3.904139719536323],
      [48.90438280191546, -4.664496482301241],
      [49.41554936842241, -5.424336949293604],
      [49.928124524320495, -6.183580786258078],
      [50.44231323993146, -6.9421470165084695],
      [50.95832207845005, -7.699953922620105],
      [51.47635940065003, -8.456918946507617],
      [51.99663556844857, -9.212958587636146],
      [52.51936315156238, -9.967988299178055],
      [53.04475713519641, -10.721922381902074],
      [53.5730351287265, -11.474673875537777],
      [54.10441757539243, -12.22615444746341],
      [54.639127960793374, -12.976274278430958],
      [55.177393023435165, -13.724941945142342],
      [55.71944297090311, -14.472064299427197],
      [56.26551168481572, -15.217546343849053],
      [56.81583693756608, -15.961291103427364],
      [57.370662101346255, -16.703201480756984],
      [57.93023038710896, -17.44317216445683],
      [58.494793989669866, -18.181101428211736],
      [59.06460835416052, -18.916883019893927],
      [59.63993386284982, -19.650408003274094],
      [60.221036042980536, -20.38156460210733],
      [60.808185760170645, -21.110238038895723],
      [61.40165941712965, -21.83631036809226],
      [62.001739139845455, -22.559660303616123],
      [62.608712955682456, -23.280163040494866],
      [63.222874970572015, -23.99769007048617],
      [63.84452552145796, -24.712108991589904],
      [64.47397132576123, -25.423283311359917],
      [65.11152561767813, -26.131072243935524],
      [65.75750825507866, -26.83533050081769],
      [66.4122458175371, -27.53590807541194],
      [67.07607167568983, -28.23265002142032],
      [67.74932603223313, -28.925396225260613],
      [68.43235593402945, -29.61398117271216],
      [69.12551524902993, -30.298233710122858],
      [69.82916460377311, -30.977976800588646],
      [70.5436712734001, -31.653027275593278],
      [71.26940902532218, -32.32319558279786],
      [72.00675789956074, -32.988285530712986],
      [72.75610393467313, -33.64809403127157],
      [73.51783881511057, -34.30241084114278],
      [74.29235944483042, -34.95101830377035],
      [75.08006743816604, -35.59369109270475],
      [75.88136850303891, -36.230195958763765],
      [76.69667173645472, -36.86029148274187],
      [77.52638879124459, -37.48372783598477],
      [78.37093292770402, -38.10024655151733],
      [79.2307179278293, -38.709580308626435],
      [80.10615686230696, -39.31145273430002],
      [80.99766070226492, -39.90557822496087],
      [81.90563676364248, -40.4916617931243],
      [82.83048697334979, -41.06939894283811],
      [83.77260594446383, -41.63847557932145],
      [84.73237886238658, -42.1985679579477],
      [85.71017915086549, -42.74934267843667],
      [86.70636593732324, -43.29045673044777],
      [87.72128129850621, -43.82155759718332],
      [88.75524727860085, -44.34228342393381],
      [89.80856269797519, -44.8522632588308],
      [90.88149974000578, -45.351117373242836],
      [91.97430329167815, -45.83845896077955],
      [93.08717535446156, -46.31388944183681],
      [94.22028864212739, -46.7770069127966],
      [95.37377078025771, -47.22740159938927],
      [96.54770294895344, -47.664658009483446],
      [97.74211555462573, -48.08835588490498],
      [98.9569838654284, -48.49807127990637],
      [100.19222366568238, -48.893377769820724],
      [101.44768700075328, -49.27384779195794],
      [102.72315807491437, -49.63905411882629],
      [104.01834937717489, -49.988571461705064],
      [105.33289813391606, -50.32197820006385],
      [106.66636315144775, -50.638858229676615],
      [108.0182221696634, -50.938802919302645],
      [109.3878697933619, -51.22141316275273],
      [110.77461611079578, -51.48630150993069],
      [112.17768607253566, -51.73309435732353],
      [113.59621972566538, -51.96143417527261],
      [115.02927335825937, -52.1709817465477],
      [116.47582161563113, -52.36141838824372],
      [117.93476062954652, -52.53244812695436],
      [119.40491217109833, -52.68379979579392],
      [120.88502882609501, -52.81522902107017],
      [122.37380017110755, -52.92652006650235],
      [123.86985988005478, -53.017487503823084],
      [125.37179370382103, -53.087977680410376],
      [126.87814820027681, -53.13786995733655],
      [128.38744010808523, -53.16707769478303],
      [129.898166203065, -53.1755489660839],
      [131.4088134942234, -53.16326698663011],
      [132.91786957958874, -53.130250249285275],
      [134.42383299434738, -53.07655236369218],
      [135.9252233779138, -53.00226160265931],
      [137.4205912808547, -52.90750016451811],
      [138.90852747586896, -52.792423165730284],
      [140.38767160616084, -52.65721738292671],
      [141.85672006989003, -52.502099767799876],
      [143.31443303177218, -52.327315761771324],
      [144.75964048067954, -52.13313743997291],
      [146.1912472945818, -51.919861515828984],
      [147.60823727628397, -51.68780723836903],
      [149.0096761673381, -51.43731421440108],
      [150.39471365227863, -51.16874018685719],
      [151.76258439660427, -50.882458799137765],
      [153.11260818201825, -50.57885737320771],
      [154.4441927396591, -50.25833384459647],
      [155.75681804972717, -49.92129812512464],
      [157.05005563997972, -49.568164901843254],
      [158.3235515300773, -49.199355087131316],
      [159.57702663059231, -48.81529314636187],
      [160.8102731490489, -48.416405382019136],
      [162.02315068797702, -48.00311834398879],
    ],
  ]);
});

it("toLonLat", () => {
  expect(
    toLonLat(
      {
        longitude: 1.457815071705606,
        latitude: 0.30670970757160354,
        height: -17.392761860713108,
      },
      [45, 0]
    )
  ).toEqual([83.52665091929269, 17.573171779544552]);

  expect(
    toLonLat(
      {
        longitude: -2.8872286235407927,
        latitude: 1.2662659264128833,
        height: 19.374220019183667,
      },
      [45, 0]
    )
  ).toEqual([194.57398538174658, 72.55169332468148]);

  expect(
    toLonLat({
      longitude: -2.8872286235407927,
      latitude: 1.2662659264128833,
      height: 19.374220019183667,
    })
  ).toEqual([-165.42601461825342, 72.55169332468148]);
});

it("footprint", () => {
  expect(footprint(tle1[0], tle1[1], new Date("2023-09-21T20:00:00Z"))).toEqual(
    [
      [150.59270385530772, 13.97078901705157],
      [151.18947825733855, 13.892715830653485],
      [151.78220025953974, 13.81188935712093],
      [152.37256631164715, 13.72812946614873],
      [152.9622335261151, 13.641224374903722],
      [153.55285147993487, 13.550926974140458],
      [154.1460937518017, 13.456949888290676],
      [154.23412052025333, 14.03905601483794],
      [154.32383928998075, 14.617172700427968],
      [154.4155111476292, 15.192968551593722],
      [154.50941804851215, 15.76807092805558],
      [154.60586830909378, 16.34409730042051],
      [154.70520306618704, 16.922686180226798],
      [154.1022911099063, 17.01006292507886],
      [153.50250668580608, 17.096934058380064],
      [152.90412551638693, 17.183540030567638],
      [152.30545254413002, 17.27011651815718],
      [151.7047893784961, 17.356898864670264],
      [151.10040162161616, 17.44412650971985],
      [151.01885848881236, 16.86293692122703],
      [150.93640179209288, 16.284859490988044],
      [150.8528051842995, 15.708238825472206],
      [150.76783026751372, 15.131447067285958],
      [150.68122206251988, 14.552852677001058],
      [150.59270385530772, 13.97078901705157],
    ]
  );

  expect(
    footprint(tle1[0], tle1[1], new Date("2023-09-21T20:00:00Z"), {
      offnadir: 20,
    })
  ).toEqual([
    [152.9581212196675, 13.6958255538264],
    [153.52252236503247, 13.557046854351134],
    [154.1251641074795, 13.405489887933111],
    [154.7721358524846, 13.23890244815326],
    [155.4711298811309, 13.054400225943644],
    [156.23207368736567, 12.848207036082284],
    [157.06811595346898, 12.615245562773959],
    [157.17032916879, 13.323106823331315],
    [157.27945061688328, 14.023108372474177],
    [157.39588643713967, 14.718333409128958],
    [157.52016910981325, 15.411740247022369],
    [157.65297235532165, 16.10624994332853],
    [157.79513403698854, 16.804831564048115],
    [156.9135839175777, 16.854619228230515],
    [156.11307341771348, 16.899586077942654],
    [155.37927199243373, 16.94059402624591],
    [154.70137903974938, 16.978291682216135],
    [154.0710401914281, 17.013179954201075],
    [153.48165293269236, 17.045654068754082],
    [153.39157337761785, 16.486092215622993],
    [153.3029718436575, 15.92899103693586],
    [153.21557714311822, 15.372875475293599],
    [153.12913327348184, 14.816289735501602],
    [153.0433945722258, 14.257771447251477],
    [152.9581212196675, 13.6958255538264],
  ]);

  expect(
    footprint(tle1[0], tle1[1], new Date("2023-09-22T23:40:00Z"), {
      fov: 100,
    })
  ).toEqual([
    [90.54882281348486, 74.48201191370454],
    [101.972317754087, 74.37404974695859],
    [112.81690939438879, 73.67468511082386],
    [122.44973954416189, 72.45805139248536],
    [130.6211713996121, 70.82830970753274],
    [137.38066112879716, 68.88868042150898],
    [142.92040135307326, 66.72560807048056],
    [147.4796066394481, 68.21170029314018],
    [152.68606975903074, 69.5498984789011],
    [158.58246639014573, 70.70475913741222],
    [165.16530333692745, 71.63765511505072],
    [172.3591907846746, 72.31023199156232],
    [180, 72.68984945753077],
    [180, 90],
    [-180, 90],
    [-180, 72.68984945753077],
    [-177.57206986534464, 72.74448121443271],
    [-175.13289979433372, 72.76841598005687],
    [-172.69128219552445, 72.76151837385308],
    [-170.25606243231513, 72.7238274861537],
    [-167.83594777739907, 72.6555558369124],
    [-165.43932374308096, 72.55708376359887],
    [-163.56422815165868, 75.50705638779307],
    [-160.71931199213165, 78.45224503688678],
    [-155.9253398124708, 81.36424971707584],
    [-146.38023251655872, 84.16594926065407],
    [-121.86714696123987, 86.54326061460196],
    [-65.35759562958184, 87.09576806386984],
    [22.177154587093128, 88.93699117944254],
    [77.58950395139972, 86.47588034233702],
    [85.32002633002467, 83.50064589684858],
    [88.17186139545213, 80.49025262516896],
    [89.64775516564733, 77.48034993393698],
    [90.54882281348486, 74.48201191370454],
  ]);

  expect(
    footprint(tle1[0], tle1[1], new Date("2023-09-22T23:40:00Z"), {
      fov: [100, 100],
    })
  ).toEqual([
    [90.54882281348486, 74.48201191370454],
    [101.972317754087, 74.37404974695859],
    [112.81690939438879, 73.67468511082386],
    [122.44973954416189, 72.45805139248536],
    [130.6211713996121, 70.82830970753274],
    [137.38066112879716, 68.88868042150898],
    [142.92040135307326, 66.72560807048056],
    [147.4796066394481, 68.21170029314018],
    [152.68606975903074, 69.5498984789011],
    [158.58246639014573, 70.70475913741222],
    [165.16530333692745, 71.63765511505072],
    [172.3591907846746, 72.31023199156232],
    [180, 72.68984945753077],
    [180, 90],
    [-180, 90],
    [-180, 72.68984945753077],
    [-177.57206986534464, 72.74448121443271],
    [-175.13289979433372, 72.76841598005687],
    [-172.69128219552445, 72.76151837385308],
    [-170.25606243231513, 72.7238274861537],
    [-167.83594777739907, 72.6555558369124],
    [-165.43932374308096, 72.55708376359887],
    [-163.56422815165868, 75.50705638779307],
    [-160.71931199213165, 78.45224503688678],
    [-155.9253398124708, 81.36424971707584],
    [-146.38023251655872, 84.16594926065407],
    [-121.86714696123987, 86.54326061460196],
    [-65.35759562958184, 87.09576806386984],
    [22.177154587093128, 88.93699117944254],
    [77.58950395139972, 86.47588034233702],
    [85.32002633002467, 83.50064589684858],
    [88.17186139545213, 80.49025262516896],
    [89.64775516564733, 77.48034993393698],
    [90.54882281348486, 74.48201191370454],
  ]);

  expect(
    footprint(tle1[0], tle1[1], new Date("2023-09-22T23:40:00Z"), {
      fov: [100, 100],
      offnadir: -5,
    })
  ).toEqual([
    [79.61213765411681, 71.08666887456056],
    [89.69879201081147, 72.33776140281441],
    [100.94163517344518, 72.98180011813339],
    [112.59663986199257, 72.94530788590845],
    [123.7465545739701, 72.23272074760764],
    [133.68421366541403, 70.92415142061311],
    [142.11139369442165, 69.13938128651486],
    [146.71474635677166, 70.52023738056923],
    [151.99582875432347, 71.76405171380074],
    [158.00499885295721, 72.8373769428074],
    [164.74356056877468, 73.70337521433133],
    [172.1340535039422, 74.32515995139296],
    [180, 74.6712331783154],
    [180, 90],
    [-180, 90],
    [-180, 74.6712331783154],
    [-178.25874407459537, 74.70764401132395],
    [-176.5107036200058, 74.7300337390454],
    [-174.75910607040632, 74.73833780677614],
    [-173.00721850528137, 74.7325321767662],
    [-171.25831124708986, 74.7126336599821],
    [-169.51562136869325, 74.67869968395867],
    [-164.8426693382188, 77.83957663774967],
    [-156.945632055733, 80.88134466791533],
    [-141.7783934576739, 83.5975013044841],
    [-110.90658647006941, 85.3434525033596],
    [-70.1612009441412, 84.96475687953799],
    [-45.24730873080383, 82.79041858645876],
    [-13.38338925837226, 85.0600412108301],
    [32.03986041129784, 84.65382729645918],
    [58.00338035271111, 81.97040362017155],
    [69.7391370730108, 78.52176084923433],
    [75.89904925035157, 74.84111536869466],
    [79.61213765411681, 71.08666887456056],
  ]);

  expect(() =>
    footprint(tle1[0], tle1[1], new Date("2023-09-21T20:00:00Z"), {
      fov: [120, 120],
    })
  ).toThrow(LookingAwayError);
});

it("accessArea", () => {
  expect(
    accessArea(
      tle1[0],
      tle1[1],
      new Date("2023-09-21T18:40:00Z"),
      new Date("2023-09-21T19:00:00Z")
    )
  ).toEqual([
    [
      [161.5527943510627, -52.441436692731266],
      [160.94367955769727, -52.360930084211894],
      [160.34643508205866, -52.278654827227555],
      [159.75614243495266, -52.19406437478109],
      [159.1681154029309, -52.10653751261727],
      [158.57773836657466, -52.0153593861093],
      [157.98030956863883, -51.91969576687542],
      [157.5063354036139, -52.85553717614471],
      [157.0139936757608, -53.789612020432095],
      [156.50184187118492, -54.721800469975],
      [155.9682899282548, -55.651969920192],
      [155.4115813784542, -56.579973248571825],
      [154.82977164420655, -57.50564679212831],
      [154.22070143235817, -58.42881031113107],
      [153.58197398218002, -59.349254960689464],
      [152.9109123465294, -60.26675399868163],
      [152.2045264950645, -61.18104970687015],
      [151.4594665073566, -62.09185124889005],
      [150.67196977261443, -62.998829382979395],
      [149.8377971889339, -63.901612445957376],
      [148.95216966750678, -64.79976979668238],
      [148.00967138394304, -65.6928164837387],
      [147.00415967065578, -66.58019340708127],
      [145.92864815056012, -67.4612566562782],
      [144.7751730670966, -68.33526189058135],
      [143.5346351348684, -69.20134760014567],
      [142.19663403273557, -70.05850348731403],
      [140.74924705513433, -70.9055557046703],
      [139.17881485486458, -71.74112433469746],
      [137.4696922189746, -72.56358463365956],
      [135.60399218042832, -73.37101761068018],
      [133.5613405411556, -74.1611508095101],
      [131.31867109395634, -74.9312901163193],
      [128.85015754704713, -75.67823067971611],
      [126.12729439288637, -76.39817696581241],
      [123.1193880680689, -77.08663706625988],
      [119.79458751488507, -77.73832914828962],
      [116.1217630710861, -78.34710454621201],
      [112.07352692679135, -78.90591768222028],
      [107.63070534722272, -79.40687435022302],
      [102.78809926071685, -79.8414299371398],
      [97.56118035297523, -80.20076095565155],
      [91.99218427663591, -80.47636053878219],
      [86.15343783230232, -80.66082180595293],
      [80.14547048628896, -80.74869737778941],
      [74.08868849466259, -80.73724004677936],
      [68.10949069253785, -80.62681380622632],
      [62.32476387141704, -80.42083706005252],
      [56.82907240476423, -80.12528075346674],
      [51.687772012225174, -79.7478802592949],
      [46.9365127437648, -79.2972786282905],
      [42.58541786208544, -78.78227872493227],
      [38.625527646732195, -78.21130455972244],
      [35.03528776815787, -77.5920631634165],
      [31.78612012089719, -76.93139591452967],
      [28.846507749901047, -76.23524728857825],
      [26.184734785802384, -75.50870975817075],
      [23.770538768148622, -74.75610499599398],
      [21.576017703131363, -73.98108867978215],
      [19.57596512375569, -73.18673611451375],
      [17.7479511519995, -72.37563919662799],
      [16.07219313320719, -71.54998336704026],
      [14.531341726085262, -70.71161514098657],
      [13.11022709836062, -69.8620968157193],
      [11.79561792144865, -69.00276239673244],
      [10.575957666140026, -68.1347439614897],
      [9.44115794611476, -67.25901249727961],
      [8.382397773282179, -66.37640239698136],
      [7.391950861804953, -65.48763338906522],
      [6.463035797538357, -64.5933286283913],
      [5.589684779032526, -63.694027383477064],
      [4.766641428274241, -62.79020648844636],
      [3.989252712579664, -61.88227707535688],
      [3.253396645456622, -60.970602199485164],
      [2.55541054542163, -60.055501772095525],
      [1.8920315645705414, -59.137258595498366],
      [1.2603441621272324, -58.21612112800455],
      [0.6577426234833581, -57.29231705526875],
      [0.08188391733943397, -56.36604303915399],
      [-0.46933829984844594, -55.43747708115065],
      [-0.99782330105971, -54.50677886183684],
      [-1.6283816609370085, -54.608428883024466],
      [-2.2519434926519266, -54.70524780338063],
      [-2.8734480996796727, -54.79811993221461],
      [-3.4977574659098853, -54.88780082815308],
      [-4.129820586154853, -54.97494437101708],
      [-4.774843863744505, -55.060122501250774],
      [-4.3282905010670705, -56.003589076675674],
      [-3.8634142547740096, -56.94568546901274],
      [-3.378606013575857, -57.88631285163486],
      [-2.8720705217390208, -58.8253605114412],
      [-2.3417976995996046, -59.76270636829072],
      [-1.7855358907404641, -60.698205379345445],
      [-1.2007459102134754, -61.63170110049125],
      [-0.5845613041241896, -62.56301317174527],
      [0.06626652507949175, -63.49193597942202],
      [0.7554323293191681, -64.41823419898476],
      [1.4871557169197536, -65.34163971196737],
      [2.2662662000693623, -66.26183574503348],
      [3.0983260953951217, -67.17846274194638],
      [3.989759090088672, -68.0910991361787],
      [4.948017475086596, -68.9992513688754],
      [5.981784342032286, -69.90233854498605],
      [7.101221310677991, -70.79967318875288],
      [8.318275744005136, -71.69043919283897],
      [9.647041426634912, -72.57365205810555],
      [11.104234055880331, -73.4481330116292],
      [12.709736532444749, -74.31244960146745],
      [14.487274306214923, -75.16485303592985],
      [16.4652120786604, -76.00319445309141],
      [18.677473675624384, -76.82481900529521],
      [21.164507436064827, -77.62641907693326],
      [23.97426609230978, -78.40387083551897],
      [27.162837729652868, -79.15200756384039],
      [30.79431688385842, -79.86436144846842],
      [34.939007857228525, -80.53287625189306],
      [39.668579184951476, -81.14763916270007],
      [45.046203538153435, -81.69672045232318],
      [51.110080151248596, -82.16631764570387],
      [57.85018185024017, -82.54141873230004],
      [65.18335164291256, -82.80723748026409],
      [72.93862526726545, -82.9514081699462],
      [80.86783887450126, -82.96645126172439],
      [88.68728498576273, -82.85155183511901],
      [96.13590336485642, -82.61276808590222],
      [103.02288995485065, -82.26155268307996],
      [109.2454961739845, -81.81235149125963],
      [114.77894737448352, -81.28028218272242],
      [119.65258454030558, -80.67951096503583],
      [123.92559324642676, -80.02242179315881],
      [127.66875208062191, -79.31938870497025],
      [130.95326491034194, -78.5788720931018],
      [133.84489851073062, -77.80767939883339],
      [136.40163763788482, -77.01125224890818],
      [138.67326314108402, -76.19393507390537],
      [140.70188332232286, -75.35920138566327],
      [142.52282225085636, -74.50984750855176],
      [144.1656428269408, -73.6481265340768],
      [145.6550626450011, -72.77587108796476],
      [147.01178458575433, -71.8945800383286],
      [148.2531973833572, -71.00548731286446],
      [149.39395814370235, -70.10961532582779],
      [150.4464736491405, -69.20781432710366],
      [151.4212811085531, -68.30080406696591],
      [152.32738270247884, -67.38918582481945],
      [153.17249445715237, -66.4734717583965],
      [153.96326082640647, -65.55409879928854],
      [154.70542790328471, -64.63144159420179],
      [155.4039872059103, -63.705820602414214],
      [156.0632856958586, -62.77751986643172],
      [156.6871329214402, -61.84677993707036],
      [157.27887402081777, -60.91381282647632],
      [157.84145826984383, -59.9788043405657],
      [158.3774948672251, -59.04191793688958],
      [158.88930102483826, -58.10329557454617],
      [159.3789363485081, -57.16306984708462],
      [159.8482439354722, -56.22135207955641],
      [160.2988735194143, -55.27824367253236],
      [160.73230694880033, -54.333835360888564],
      [161.1498788479723, -53.38820859014819],
      [161.5527943510627, -52.441436692731266],
    ],
  ]);

  expect(
    accessArea(
      tle1[0],
      tle1[1],
      new Date("2023-09-21T18:40:00Z"),
      new Date("2023-09-21T19:00:00Z"),
      {
        roll: [10, 0],
      }
    )
  ).toEqual([
    [
      [161.5527943510627, -52.441436692731266],
      [161.24643196131385, -52.401372824057326],
      [160.94367955769727, -52.360930084211894],
      [160.6438883625706, -52.32004612873298],
      [160.34643508205866, -52.278654827227555],
      [160.05071616348778, -52.236685883036365],
      [159.75614243495266, -52.19406437478109],
      [159.31688848672698, -53.13578747756528],
      [158.86104024290148, -54.07606874356445],
      [158.38726323592664, -55.01481236736471],
      [157.89408283111499, -55.951912124624826],
      [157.37986563418548, -56.8872499062739],
      [156.84279795401196, -57.82069401010659],
      [156.2808593278199, -58.752099481814],
      [155.69179907092607, -59.6812964057582],
      [155.07309372036005, -60.60810119360064],
      [154.4219126526507, -61.532303939800144],
      [153.73506971220084, -62.453666881488196],
      [153.00896780301693, -63.371919764588355],
      [152.2395313536359, -64.28675658872884],
      [151.42213646294167, -65.19781973532238],
      [150.55150693606893, -66.10470570010868],
      [149.62161189129512, -67.0069460837813],
      [148.62553263413142, -67.90399794852051],
      [147.55530597070566, -68.79522918300826],
      [146.40173415879858, -69.67990271485377],
      [145.154173854415, -70.55714539188293],
      [143.80025420962897, -71.42593376846291],
      [142.32557641706208, -72.28505091775313],
      [140.7133476611229, -73.13304597158167],
      [138.94396598705308, -73.96818090601761],
      [136.9945607255841, -74.78836431997192],
      [134.83850523683085, -75.59107141525601],
      [132.44498510080237, -76.37323536007479],
      [129.7786351546611, -77.13113808075151],
      [126.79952463426831, -77.86025998676269],
      [123.46369636924892, -78.55512356414988],
      [119.72473407116989, -79.209132132531],
      [115.5369618296475, -79.81443636758458],
      [110.86107580505943, -80.36187266777092],
      [105.67263563698806, -80.8410789886599],
      [99.973479837581, -81.24086569975826],
      [93.80413582933, -81.54996596251536],
      [87.25318580665662, -81.75818013419894],
      [80.45780459335299, -81.8577715247165],
      [73.59117778734927, -81.84476207254431],
      [66.83766037522349, -81.71968220348924],
      [60.363970917240756, -81.48746655054636],
      [54.2967315841847, -81.15654351973967],
      [48.71301177502616, -80.73747661257156],
      [43.64341632424305, -80.24160254341346],
      [39.08262293544113, -79.67997096793108],
      [35.001881115782666, -79.06269335989978],
      [31.35975203234947, -78.39862963906225],
      [28.11000151827974, -77.69533326125025],
      [25.206565561401323, -76.9591299853836],
      [22.606319871244196, -76.19526253845798],
      [20.27035780144932, -75.40805109173506],
      [18.164391213745564, -74.60105671610509],
      [16.258591256201065, -73.77720703023022],
      [14.527241622051427, -72.93892052193236],
      [12.948265608449875, -72.08820069654857],
      [11.502746467509748, -71.22671420460249],
      [10.174473550926553, -70.355851633092],
      [8.949551889170099, -69.47678687697072],
      [7.816030989737065, -68.5905045808111],
      [6.763617956934518, -67.69784146798378],
      [5.783419567812626, -66.79951039036291],
      [4.867728163981589, -65.89612150342386],
      [4.0098420615137504, -64.98819942567883],
      [3.20391315455784, -64.07619490329587],
      [2.444828880364058, -63.160505404512485],
      [1.728094412700012, -62.2414707256158],
      [1.0497521335140596, -61.3193898793112],
      [0.40630483552414887, -60.39452520441477],
      [-0.2053473128757802, -59.467107688982594],
      [-0.7879615390561375, -58.537339077621255],
      [-1.3439919403022371, -57.60540496205737],
      [-1.8756367808611158, -56.6714638980985],
      [-2.384865447975305, -55.73565941331718],
      [-2.8734480996796727, -54.79811993221461],
      [-3.1849468509537617, -54.84331629674367],
      [-3.4977574659098853, -54.88780082815308],
      [-3.8125025348853177, -54.931652290060015],
      [-4.129820586154853, -54.97494437101708],
      [-4.450371754241515, -55.017746154325934],
      [-4.774843863744505, -55.060122501250774],
      [-4.3282905010670705, -56.003589076675674],
      [-3.8634142547740096, -56.94568546901274],
      [-3.378606013575857, -57.88631285163486],
      [-2.8720705217390208, -58.8253605114412],
      [-2.3417976995996046, -59.76270636829072],
      [-1.7855358907404641, -60.698205379345445],
      [-1.2007459102134754, -61.63170110049125],
      [-0.5845613041241896, -62.56301317174527],
      [0.06626652507949175, -63.49193597942202],
      [0.7554323293191681, -64.41823419898476],
      [1.4871557169197536, -65.34163971196737],
      [2.2662662000693623, -66.26183574503348],
      [3.0983260953951217, -67.17846274194638],
      [3.989759090088672, -68.0910991361787],
      [4.948017475086596, -68.9992513688754],
      [5.981784342032286, -69.90233854498605],
      [7.101221310677991, -70.79967318875288],
      [8.318275744005136, -71.69043919283897],
      [9.647041426634912, -72.57365205810555],
      [11.104234055880331, -73.4481330116292],
      [12.709736532444749, -74.31244960146745],
      [14.487274306214923, -75.16485303592985],
      [16.4652120786604, -76.00319445309141],
      [18.677473675624384, -76.82481900529521],
      [21.164507436064827, -77.62641907693326],
      [23.97426609230978, -78.40387083551897],
      [27.162837729652868, -79.15200756384039],
      [30.79431688385842, -79.86436144846842],
      [34.939007857228525, -80.53287625189306],
      [39.668579184951476, -81.14763916270007],
      [45.046203538153435, -81.69672045232318],
      [51.110080151248596, -82.16631764570387],
      [57.85018185024017, -82.54141873230004],
      [65.18335164291256, -82.80723748026409],
      [72.93862526726545, -82.9514081699462],
      [80.86783887450126, -82.96645126172439],
      [88.68728498576273, -82.85155183511901],
      [96.13590336485642, -82.61276808590222],
      [103.02288995485065, -82.26155268307996],
      [109.2454961739845, -81.81235149125963],
      [114.77894737448352, -81.28028218272242],
      [119.65258454030558, -80.67951096503583],
      [123.92559324642676, -80.02242179315881],
      [127.66875208062191, -79.31938870497025],
      [130.95326491034194, -78.5788720931018],
      [133.84489851073062, -77.80767939883339],
      [136.40163763788482, -77.01125224890818],
      [138.67326314108402, -76.19393507390537],
      [140.70188332232286, -75.35920138566327],
      [142.52282225085636, -74.50984750855176],
      [144.1656428269408, -73.6481265340768],
      [145.6550626450011, -72.77587108796476],
      [147.01178458575433, -71.8945800383286],
      [148.2531973833572, -71.00548731286446],
      [149.39395814370235, -70.10961532582779],
      [150.4464736491405, -69.20781432710366],
      [151.4212811085531, -68.30080406696591],
      [152.32738270247884, -67.38918582481945],
      [153.17249445715237, -66.4734717583965],
      [153.96326082640647, -65.55409879928854],
      [154.70542790328471, -64.63144159420179],
      [155.4039872059103, -63.705820602414214],
      [156.0632856958586, -62.77751986643172],
      [156.6871329214402, -61.84677993707036],
      [157.27887402081777, -60.91381282647632],
      [157.84145826984383, -59.9788043405657],
      [158.3774948672251, -59.04191793688958],
      [158.88930102483826, -58.10329557454617],
      [159.3789363485081, -57.16306984708462],
      [159.8482439354722, -56.22135207955641],
      [160.2988735194143, -55.27824367253236],
      [160.73230694880033, -54.333835360888564],
      [161.1498788479723, -53.38820859014819],
      [161.5527943510627, -52.441436692731266],
    ],
  ]);

  expect(
    accessArea(
      tle1[0],
      tle1[1],
      new Date("2023-09-21T18:40:00Z"),
      new Date("2023-09-21T19:00:00Z"),
      {
        roll: 60,
      }
    )
  ).toEqual([
    [
      [183.29081080402656, -53.20417705941199],
      [168.8366632536616, -53.14623989044908],
      [163.50805346522836, -52.67693839390048],
      [159.75614243495266, -52.19406437478109],
      [156.09379612946154, -51.59483954990993],
      [151.17990305076066, -50.57950519219711],
      [139.22197070511714, -46.954537879427775],
      [138.48819204073462, -47.777782404620446],
      [137.7278913297638, -48.59490854345852],
      [136.93968332248517, -49.405554356066],
      [136.12210542247527, -50.20933148589227],
      [135.2736149414535, -51.00582306321925],
      [134.39258674548827, -51.79458146264703],
      [133.47730909104706, -52.57512786503299],
      [132.52599182633625, -53.346941891071054],
      [131.53675244844786, -54.10947070361458],
      [130.50762629132012, -54.862118329253384],
      [129.43656688089217, -55.604244714748994],
      [128.321450470365, -56.33516272493166],
      [127.16007993620885, -57.05413688469841],
      [125.9502063292669, -57.76037312886228],
      [124.68952453547222, -58.45302667277045],
      [123.37570209166991, -59.131191922342765],
      [122.00639833282088, -59.793901732477075],
      [120.5792918995024, -60.44012523668809],
      [119.09211064642965, -61.06876779040525],
      [117.5426874131947, -61.67866382535178],
      [115.92898578867567, -62.26858644450955],
      [114.2491710692899, -62.83724238419586],
      [112.50167087661187, -63.3832764579827],
      [110.68524730763261, -63.90527620529544],
      [108.79907616868263, -64.40177865444895],
      [106.8428268150443, -64.87128063912105],
      [104.8167701614362, -65.31224597850128],
      [102.72183742556558, -65.72312725283307],
      [100.55972378314203, -66.10237862638117],
      [98.3329585255158, -66.44847754658642],
      [96.04496503251544, -66.75994784531191],
      [93.70009362700245, -67.03538563945965],
      [91.30365689504735, -67.27348336318619],
      [88.8618734008752, -67.47306117578903],
      [86.38183401988385, -67.63309076134891],
      [83.87140118089569, -67.75272089786218],
      [81.3390773096029, -67.8312991591966],
      [78.79383444591298, -67.8683893015074],
      [76.24495063147381, -67.86378294131464],
      [76.24495063147381, -90],
      [263.3928000260874, -90],
      [263.3928000260874, -84.12299175371628],
      [254.31189890998942, -84.14047358222523],
      [245.41167670474448, -84.00682139882272],
      [237.10697952419096, -83.73169479642115],
      [229.66387072716446, -83.33258177823687],
      [223.18171392554825, -82.83015410995516],
      [217.63517221766722, -82.24446024452759],
      [212.931043723432, -81.5928792135303],
      [208.95208277403668, -80.88952878392878],
      [205.58229545283214, -80.14548402103578],
      [202.71821696428356, -79.36927762081586],
      [200.27229127588564, -78.56745107781707],
      [198.17237834451, -77.74502459394868],
      [196.35980020742363, -76.90587136619853],
      [194.78705414144503, -76.05300021093383],
      [193.41569933229223, -75.188776635046],
      [192.21452112803792, -74.31506728134939],
      [191.15807085899587, -73.43336492048226],
      [190.22548512508618, -72.54487281862765],
      [189.3995584263916, -71.65056937854031],
      [188.66601520067672, -70.75125680541895],
      [188.01293695901236, -69.84759576544505],
      [187.43031928137324, -68.94014275501704],
      [186.9097072202003, -68.0293582833433],
      [186.44392063070427, -67.11563293284138],
      [186.0268280704384, -66.19929841400246],
      [185.65316692540688, -65.28063809900534],
      [185.31839761290712, -64.35989309558342],
      [185.0185892891409, -63.43727824644884],
      [184.75031899056285, -62.51297367640078],
      [184.51059653658191, -61.58713847202442],
      [184.2967989366591, -60.65991198808951],
      [184.10661679390577, -59.73141682641326],
      [183.938009308762, -58.80175896241684],
      [183.78916863123573, -57.87103915071609],
      [183.6584859983616, -56.939340614848966],
      [183.5445270518467, -56.00673983791958],
      [183.44600900256972, -55.07330544448052],
      [183.36178158619842, -54.13909923369193],
      [183.29081080402656, -53.20417705941199],
    ],
    [
      [-96.6071999739126, -90],
      [76.24495063147381, -90],
      [76.24495063147381, -67.86378294131464],
      [73.70176651930429, -67.8175059146498],
      [71.17350147037531, -67.72981707747917],
      [68.66904475352062, -67.6012012567625],
      [66.19677109668915, -67.43235604274989],
      [63.764383333038786, -67.2241733895824],
      [61.378782704263934, -66.97771645062772],
      [59.0460061283664, -66.69419681045305],
      [56.77114124202549, -66.37494386612472],
      [54.55833717495369, -66.02137999430921],
      [52.41081655924316, -65.63499351631546],
      [50.33091952236338, -65.2173138656799],
      [48.32016252719844, -64.76988786921662],
      [46.37933589432771, -64.29426445436783],
      [44.50855893159192, -63.7919709194338],
      [42.70738889857717, -63.264503315049886],
      [40.97490353236879, -62.71331412475753],
      [39.30978482881678, -62.13980364646513],
      [37.71039287575649, -61.545312199553244],
      [36.17485224365318, -60.931121932186116],
      [34.70109035511042, -60.298445362817844],
      [33.286908123663125, -59.64843027060949],
      [31.930022335868085, -58.98215835441165],
      [30.628104734072288, -58.30064628104935],
      [29.37881431255748, -57.60484743689008],
      [28.179820596369247, -56.895652397929815],
      [27.028836481416313, -56.17389872934372],
      [25.923616449910543, -55.4403631504091],
      [24.861981124262083, -54.695771637744336],
      [23.841823257539588, -53.94080071187964],
      [22.861114063263607, -53.176080480499415],
      [21.91790495986974, -52.40219566729504],
      [21.010339207590132, -51.61969631320951],
      [20.13663846925869, -50.8290888764789],
      [19.295112010903175, -50.030846641017],
      [18.484153017016556, -49.22541028571508],
      [6.142668092759823, -53.07927481833713],
      [0.9901371682105264, -54.16119966786173],
      [-2.8734480996796727, -54.79811993221461],
      [-6.847863975478211, -55.308603423858024],
      [-12.51230319070851, -55.797470101100586],
      [-27.89046064576642, -55.79152807383725],
      [-28.00071370513832, -56.72439073112608],
      [-28.12738515533961, -57.65636607506658],
      [-28.27187276560546, -58.58737949197597],
      [-28.43574279769901, -59.517347589907],
      [-28.62075593138652, -60.44617914564454],
      [-28.828895463269742, -61.37376411658342],
      [-29.062405908546506, -62.29998568614064],
      [-29.32383398653842, -63.22470855531517],
      [-29.616080415138068, -64.14777842874048],
      [-29.9424618611331, -65.06901855532254],
      [-30.306787000549335, -65.98822781488062],
      [-30.713444275796537, -66.90516629285048],
      [-31.167519493609497, -67.81956274178634],
      [-31.674930395995105, -68.73109735658706],
      [-32.242598641379075, -69.63939409646959],
      [-32.8786629753923, -70.54400806998984],
      [-33.59274627158748, -71.44440948503964],
      [-34.39629394584696, -72.33996530941936],
      [-35.30299117619254, -73.22990365556673],
      [-36.32931553932711, -74.11329258184591],
      [-37.495217752382345, -74.98898542054565],
      [-38.82500103491016, -75.85556251029223],
      [-40.348435855596364, -76.7112503360435],
      [-42.10216823730861, -77.55381490862378],
      [-44.131435526960004, -78.38040650961541],
      [-46.492155796423724, -79.18737403236511],
      [-49.253185652520806, -79.96998987272877],
      [-52.498423661868635, -80.7220995732314],
      [-56.327783041700705, -81.4356720741678],
      [-60.855036433212405, -82.10026842568651],
      [-66.19874279097303, -82.7025004001608],
      [-72.46079981644732, -83.22572530454173],
      [-79.6869111914467, -83.65038892939631],
      [-87.81123568609506, -83.95568697380341],
      [-96.6071999739126, -84.12299175371628],
      [-96.6071999739126, -90],
    ],
  ]);

  expect(
    accessArea(
      tle2[0],
      tle2[1],
      new Date("2023-09-20T10:43:00.000Z"),
      new Date("2023-09-20T11:03:00.000Z"),
      {
        roll: 60,
      }
    )
  ).toEqual([
    [
      [117.02283719703993, 43.72799102000564],
      [122.02748220275126, 39.986625562192124],
      [124.02058156425701, 38.306409889225215],
      [125.42669590317679, 37.050986877436394],
      [126.7885804200303, 35.777767409047506],
      [128.5788608176302, 34.015599575908674],
      [132.47850650155362, 29.816091879033387],
      [133.27536740038573, 30.391410876977563],
      [134.08405107171987, 30.958931583233703],
      [134.9047747428134, 31.5184107753575],
      [135.73774783893668, 32.06959974469471],
      [136.58317086821245, 32.612244365033455],
      [137.44123424835382, 33.14608518904334],
      [138.312117061267, 33.670857574381145],
      [139.1959857288921, 34.18629184213936],
      [140.09299263883202, 34.69211347010012],
      [141.00327469187695, 35.1880433232782],
      [141.92695179982732, 35.67379792424712],
      [142.86412532816766, 36.14908976560381],
      [143.8148764918032, 36.61362766689504],
      [144.77926471885004, 37.06711717809018],
      [145.75732598172627, 37.509261031547524],
      [146.74907380109508, 37.93976078288905],
      [147.7544868854122, 38.358312776848784],
      [148.7735234285174, 38.764615682460445],
      [149.8061088761653, 39.158366500763506],
      [150.85213698872454, 39.53926244660017],
      [151.91146833000795, 39.90700171201293],
      [152.98392885840744, 40.26128428034306],
      [154.06930862671024, 40.60181278898279],
      [155.1673606294624, 40.928293437935665],
      [156.2777998106561, 41.2404369405366],
      [157.4003022658706, 41.53795951182647],
      [158.53450465226194, 41.82058388920922],
      [159.68000384225968, 42.088040379143095],
      [160.8363568349825, 42.34006792276671],
      [162.00308094249476, 42.57641517256791],
      [163.17965428319428, 42.796841571422185],
      [164.3655165715937, 43.0011184247005],
      [165.56007024194844, 43.18902995556674],
      [166.76268189524964, 43.360374333186705],
      [167.9726840713329, 43.514964663288296],
      [169.18937735408355, 43.65262993043636],
      [170.41203278394417, 43.77321588147033],
      [171.63989457811036, 43.87658583985033],
      [172.8721831295187, 43.962621441149736],
      [174.10809826302463, 44.031223280638336],
      [175.346822712775, 44.08231146477941],
      [176.5875257979834, 44.115826059551665],
      [177.82936724437252, 44.131727429732926],
      [179.07150111259264, 44.129996464659925],
      [180.3130798017131, 44.110634687453576],
      [180.55214588330634, 49.285082354245404],
      [180.67148433598894, 51.52091783378723],
      [180.7667503340446, 53.16119223095058],
      [180.86952342871416, 54.800385227412335],
      [181.02361845984623, 57.03121687728125],
      [181.46217593078788, 62.17680749919482],
      [179.52142852025622, 62.20622920627229],
      [177.57854134104412, 62.20944997342041],
      [175.63682193183288, 62.186454828133144],
      [173.69956508410525, 62.13730353393104],
      [171.77001558508292, 62.062129725946434],
      [169.85133236628045, 61.961139025717394],
      [167.94655501086734, 61.834606196245815],
      [166.05857346242095, 61.68287142747638],
      [164.19010163729425, 61.50633586642999],
      [162.3436554332943, 61.30545652411638],
      [160.5215354494076, 61.08074070254945],
      [158.7258145268434, 60.83274008950483],
      [156.95833005207058, 60.56204466658397],
      [155.22068077867968, 60.26927656841206],
      [153.51422782548795, 59.955084018467105],
      [151.84009938137947, 59.62013545131635],
      [150.1991985936569, 59.265113913208346],
      [148.59221410029537, 58.89071181413783],
      [147.0196326178837, 58.497626085811746],
      [145.48175306756076, 58.08655378210637],
      [143.9787017184873, 57.65818814243282],
      [142.51044789614974, 57.21321512414491],
      [141.0768198660432, 56.75231039814544],
      [139.67752054465265, 56.27613679212677],
      [138.31214277487908, 55.785342158377844],
      [136.98018394192937, 55.28055763767693],
      [135.68105978155788, 54.762396287189326],
      [134.41411725470172, 54.23145203831756],
      [133.1786464363951, 53.688298949734765],
      [131.97388818226358, 53.133489217954846],
      [130.79905679664014, 52.567558902675444],
      [129.65332946041704, 51.99101893351686],
      [128.53586707880967, 51.40436113733067],
      [127.44581791570478, 50.808057009872286],
      [126.38232363990794, 50.20255807581398],
      [125.34452455939358, 49.58829634260672],
      [124.33156412075368, 48.96568482882543],
      [123.3425927342068, 48.33511815010224],
      [122.3767709886075, 47.696973147883085],
      [121.43327233078419, 47.05160954839389],
      [120.5112852451285, 46.399370640992196],
      [119.61001502067988, 45.74058396681674],
      [118.72868513131284, 45.07556201017608],
      [117.86653828456687, 44.40460288616039],
      [117.02283719703993, 43.72799102000564],
    ],
    [
      [-178.53782406921212, 62.17680749919482],
      [-178.97638154015377, 57.03121687728125],
      [-179.13047657128584, 54.800385227412335],
      [-179.2332496659554, 53.16119223095058],
      [-179.32851566401106, 51.52091783378723],
      [-179.44785411669366, 49.28508235424539],
      [-179.6869201982869, 44.110634687453576],
      [-178.44674194014198, 44.07366424625173],
      [-177.20880302327137, 44.01912778757293],
      [-175.9739320989873, 43.947088213522015],
      [-174.74294376088667, 43.857628326085546],
      [-173.5166349001676, 43.750850363226384],
      [-172.29578126418141, 43.62687543284598],
      [-171.08113423701903, 43.48584285188724],
      [-169.87341788845714, 43.32790939889757],
      [-168.67332630378792, 43.15324848923914],
      [-167.48152121620777, 42.96204928279318],
      [-166.29862996337204, 42.7545157344667],
      [-165.1252437638689, 42.53086559808414],
      [-163.9619163276365, 42.29132939428582],
      [-162.80916278656002, 42.036149352969666],
      [-161.6674589524281, 41.7655783404824],
      [-160.53723786582836, 41.4798779950016],
      [-159.41890174511414, 41.17932075797261],
      [-158.3128039303054, 40.86418421296037],
      [-157.21926143485643, 40.534753068987506],
      [-156.13855251590607, 40.191317399289304],
      [-155.07091751133575, 39.83417165932939],
      [-154.01655986014194, 39.46361374318623],
      [-152.975647278186, 39.079944082667225],
      [-151.94831307915507, 38.68346479267577],
      [-150.93465760192788, 38.274478865527435],
      [-149.93474973573393, 37.85328941617431],
      [-148.94862850302863, 37.42019897953258],
      [-147.97630470283787, 36.97550886050637],
      [-147.01776257509616, 36.51951853671413],
      [-146.0729614801252, 36.052525113338895],
      [-145.14183757767796, 35.57482282916873],
      [-144.22430548570327, 35.08670261243932],
      [-143.32025991784593, 34.58845168478112],
      [-142.4295772741618, 34.080353211356545],
      [-138.81861169650892, 38.491029911428576],
      [-137.12535477797041, 40.35618399075348],
      [-135.8225016726416, 41.708487068550134],
      [-134.4637041392176, 43.04570757389341],
      [-132.51322811816624, 44.84153047551914],
      [-127.47869785603591, 48.86948538396103],
      [-128.4868903639939, 49.49020645251172],
      [-129.5195778567132, 50.102809610651],
      [-130.57761320085078, 50.70688768756046],
      [-131.6618537679805, 51.30201460100285],
      [-132.77315716610246, 51.88774480390382],
      [-133.91237624469085, 52.46361279929608],
      [-135.08035332223434, 53.02913274212539],
      [-136.27791356093226, 53.58379814891496],
      [-137.50585743477893, 54.12708173885314],
      [-138.7649522388123, 54.65843543232599],
      [-140.0559225873146, 55.17729053551001],
      [-141.37943989662966, 55.683058141832205],
      [-142.7361108256352, 56.175129783025874],
      [-144.1264647154093, 56.65287836398806],
      [-145.55094007034936, 57.115659416243695],
      [-147.0098701923644, 57.56281270456887],
      [-148.50346809721623, 57.993664219782296],
      [-150.03181091251577, 58.40752858772133],
      [-151.59482826219423, 58.80371295790901],
      [-153.19226959314446, 59.18151611028062],
      [-154.8237139541799, 59.540238613421685],
      [-156.48853881626871, 59.87918277145392],
      [-158.18591106960977, 60.197658410059965],
      [-159.91477576408914, 60.49498799721113],
      [-161.67384730612704, 60.770512137005916],
      [-163.46160365862008, 61.02359536987701],
      [-165.27628409250903, 61.253632193460255],
      [-167.1158909613392, 61.46005320014256],
      [-168.97819590608344, 61.642331210682485],
      [-170.86075075636444, 61.79998726968339],
      [-172.76090324841417, 61.93259635927379],
      [-174.67581751859686, 62.03979268323347],
      [-176.60249911054757, 62.12127437591826],
      [-178.53782406921212, 62.17680749919482],
    ],
  ]);

  expect(() =>
    accessArea(
      tle1[0],
      tle1[1],
      new Date("2023-09-21T18:40:00Z"),
      new Date("2023-09-21T19:00:00Z"),
      {
        roll: 80,
      }
    )
  ).toThrow(LookingAwayError);
});
